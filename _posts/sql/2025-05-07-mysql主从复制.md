---
title: "mysql主从复制"
tags: sql
---



主数据库修改/etc/my.cnf,添加内容

```
#进入容器
docker exec -it mysql-a bash

#查看配置文件
cat -n /etc/my.cnf

#添加内容
sed -i '5i\ log-bin=mysql-bin' /etc/my.cnf
sed -i '6i\ server-id=81' /etc/my.cnf
cat -n /etc/my.cnf
exit
docker restart mysql-a

#编辑错误可以替换修改
 sed -i 's/被替换/替换/g' /etc/my.cnf
```
登录MySQL主库,创建主从复制权限用户
```
CREATE USER 'masterslave'@'%' IDENTIFIED BY 'MasterslavePs5!';
GRANT REPLICATION SLAVE ON *.* to 'masterslave'@'%';
FLUSH PRIVILEGES;

#查询主库状态,执行后记录File和Position的值后不要对主库进行操作
show master status;

```

从数据库修改/etc/my.cnf,添加内容
```
#进入容器
docker exec -it mysql-a bash

#查看配置文件
cat -n /etc/my.cnf

#添加内容
sed -i '5i\ server-id=82' /etc/my.cnf
cat -n /etc/my.cnf
exit
docker restart mysql-a
```
登录MySQL从库,开启主从复制连接
```
change master to master_host='10.24.0.81',master_user='masterslave',master_password='MasterslavePs5!',master_log_file='mysql-bin.000001',master_log_pos=833;
start slave;
```
查看主从复制是否绑定成功
```
show slave status;
查看Slave IO Running和Slave SQL Running为YES则成功
```